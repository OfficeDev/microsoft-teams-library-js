var microsoftTeams;!function(t){"use strict";function n(){if(!W){W=!0,S=this._window||window;var t=function(t){return g(t)};S.addEventListener("message",t,!1),I=S.parent!==S.self?S.parent:S.opener;try{N="*";var n=C(I,"initialize",[D]);j[n]=function(t,n){M=t,O=n}}finally{N=null}this._uninitialize=function(){M===x.settings&&X.registerOnSaveHandler(null),M===x.remove&&X.registerOnRemoveHandler(null),W=!1,I=null,N=null,R=[],L=null,H=null,_=[],V=0,j={},M=null,O=null,S.removeEventListener("message",t,!1)}}}function e(t){h();var n=C(I,"getContext");j[n]=t}function i(t){h(),z=t}function a(t){z&&z(t),L&&C(L,"themeChange",[t])}function o(t){h(),B=t}function r(t){B&&B(t)}function s(t){h(x.content,x.settings,x.remove);var n=C(I,"navigateCrossDomain",[t]);j[n]=function(t){if(!t)throw new Error("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")}}function c(t,n){h();var e=C(I,"getTabInstances",[n]);j[e]=t}function u(t,n){h();var e=C(I,"getMruTabInstances",[n]);j[e]=t}function f(t){h(x.content),C(I,"shareDeepLink",[t.subEntityId,t.subEntityLabel,t.subEntityWebUrl])}function l(t){h();var n=C(I,"navigateToTab",[t]);j[n]=function(t){if(!t)throw new Error("Invalid internalTabInstanceId and/or channelId were/was provided")}}function h(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!W)throw new Error("The library has not yet been initialized");if(M&&t&&t.length>0){for(var e=!1,i=0;i<t.length;i++)if(t[i]===M){e=!0;break}if(!e)throw new Error("This call is not allowed in the '"+M+"' context")}}function g(t){if(t&&t.data&&"object"==typeof t.data){var n=t.source||t.originalEvent.source,e=t.origin||t.originalEvent.origin;n===S||e!==S.location.origin&&F.indexOf(e.toLowerCase())===-1||(d(n,e),n===I?v(t):n===L&&p(t))}}function d(t,n){I&&t!==I?L&&t!==L||(L=t,H=n):(I=t,N=n),I&&I.closed&&(I=null,N=null),L&&L.closed&&(L=null,H=null),b(I),b(L)}function v(t){if("id"in t.data){var n=t.data,e=j[n.id];e&&(e.apply(null,n.args),delete j[n.id])}else if("func"in t.data){var n=t.data,i=U[n.func];i&&i.apply(this,n.args)}}function p(t){if("id"in t.data&&"func"in t.data){var n=t.data,e=U[n.func];if(e){var i=e.apply(this,n.args);i&&T(L,n.id,Array.isArray(i)?i:[i])}else{var a=C(I,n.func,n.args);j[a]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];L&&T(L,n.id,t)}}}}function m(t){return t===I?R:t===L?_:[]}function y(t){return t===I?N:t===L?H:null}function b(t){for(var n=y(t),e=m(t);t&&n&&e.length>0;)t.postMessage(e.shift(),n)}function w(t,n){var e=S.setInterval(function(){0===m(t).length&&(clearInterval(e),n())},100)}function C(t,n,e){var i=k(n,e),a=y(t);return t&&a?t.postMessage(i,a):m(t).push(i),i.id}function T(t,n,e){var i=E(n,e),a=y(t);t&&a&&t.postMessage(i,a)}function k(t,n){return{id:V++,func:t,args:n||[]}}function E(t,n){return{id:t,args:n||[]}}var S,I,N,L,H,M,O,z,D="1.2",F=["https://teams.microsoft.com","https://teams.microsoft.us","https://int.teams.microsoft.com","https://devspaces.skype.com","https://ssauth.skype.com","http://dev.local"],U={},x={settings:"settings",content:"content",authentication:"authentication",remove:"remove"},A={desktop:"desktop",web:"web"},W=!1,R=[],_=[],V=0,j={};U.themeChange=a;var B;U.fullScreenChange=r,t.initialize=n,t.getContext=e,t.registerOnThemeChangeHandler=i,t.registerFullScreenHandler=o,t.navigateCrossDomain=s,t.getTabInstances=c,t.getMruTabInstances=u,t.shareDeepLink=f,t.navigateToTab=l;var X;!function(t){function n(t){h(x.settings,x.remove),C(I,"settings.setValidityState",[t])}function e(t){h(x.settings,x.remove);var n=C(I,"settings.getSettings");j[n]=t}function i(t){h(x.settings),C(I,"settings.setSettings",[t])}function a(t){h(x.settings),c=t}function o(t){h(x.remove),u=t}function r(){var t=new f;c?c(t):t.notifySuccess()}function s(){var t=new l;u?u(t):t.notifySuccess()}var c,u;U["settings.save"]=r,U["settings.remove"]=s,t.setValidityState=n,t.getSettings=e,t.setSettings=i,t.registerOnSaveHandler=a,t.registerOnRemoveHandler=o;var f=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),C(I,"settings.save.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),C(I,"settings.save.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},t}(),l=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),C(I,"settings.remove.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),C(I,"settings.remove.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},t}()}(X=t.settings||(t.settings={}));var Y;!function(t){function n(t){if(h(x.content,x.settings,x.remove),O===A.desktop){var n=document.createElement("a");n.href=t.url;var e=C(I,"authentication.authenticate",[n.href,t.width,t.height]);j[e]=function(n,e){n?t.successCallback(e):t.failureCallback(e)}}else o(t)}function e(t){h();var n=C(I,"authentication.getAuthToken",[t.resources]);j[n]=function(n,e){n?t.successCallback(e):t.failureCallback(e)}}function i(t){h();var n=C(I,"authentication.getUser");j[n]=function(n,e){n?t.successCallback(e):t.failureCallback(e)}}function a(){r();try{L&&L.close()}finally{L=null,H=null}}function o(t){g=t,a();var n=g.width||600,e=g.height||400;n=Math.min(n,S.outerWidth-400),e=Math.min(e,S.outerHeight-200);var i=document.createElement("a");i.href=g.url;var o="undefined"!=typeof S.screenLeft?S.screenLeft:S.screenX,r="undefined"!=typeof S.screenTop?S.screenTop:S.screenY;o+=S.outerWidth/2-n/2,r+=S.outerHeight/2-e/2,L=S.open(i.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, top="+r+", left="+o+", width="+n+", height="+e),L?s():l("FailedToOpenWindow")}function r(){d&&(clearInterval(d),d=0),delete U.initialize,delete U.navigateCrossDomain}function s(){r(),d=S.setInterval(function(){if(!L||L.closed)l("CancelledByUser");else{var t=H;try{H="*",C(L,"ping")}finally{H=t}}},100),U.initialize=function(){return[x.authentication,O]},U.navigateCrossDomain=function(t){return!1}}function c(t){h(x.authentication),C(I,"authentication.authenticate.success",[t]),w(I,function(){return S.close()})}function u(t){h(x.authentication),C(I,"authentication.authenticate.failure",[t]),w(I,function(){return S.close()})}function f(t){try{g&&g.successCallback&&g.successCallback(t)}finally{g=null,a()}}function l(t){try{g&&g.failureCallback&&g.failureCallback(t)}finally{g=null,a()}}var g,d;U["authentication.authenticate.success"]=f,U["authentication.authenticate.failure"]=l,t.authenticate=n,t.getAuthToken=e,t.getUser=i,t.notifySuccess=c,t.notifyFailure=u}(Y=t.authentication||(t.authentication={}))}(microsoftTeams||(microsoftTeams={}));