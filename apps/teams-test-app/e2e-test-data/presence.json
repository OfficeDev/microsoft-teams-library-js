{
  "name": "Presence",
  "featureTests": [
    {
      "feature": {
        "id": "presence",
        "version": 2
      },
      "testCases": [
        {
          "title": "getPresence API Call - Success",
          "type": "callResponse",
          "boxSelector": "#box_getPresence",
          "inputValue": {
            "upn": "user@contoso.com"
          },
          "expectedAlertValue": "getPresence called for user: user@contoso.com",
          "expectedTestAppValue": "{\"status\":\"Available\",\"customMessage\":\"Mock presence status\"}"
        },
        {
          "title": "getPresence API Call - Invalid UPN",
          "type": "callResponse",
          "boxSelector": "#box_getPresence",
          "inputValue": {
            "upn": ""
          },
          "expectedTestAppValue": "Error: Error: UPN is required"
        },
        {
          "title": "setPresence API Call - Success",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "Busy",
            "customMessage": "In a meeting"
          },
          "expectedAlertValue": "setPresence called with status: Busy and message: In a meeting",
          "expectedTestAppValue": "Presence set successfully"
        },
        {
          "title": "setPresence API Call - Success without custom message",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "Available"
          },
          "expectedAlertValue": "setPresence called with status: Available and message: none",
          "expectedTestAppValue": "Presence set successfully"
        },
        {
          "title": "setPresence API Call - Invalid Status",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "InvalidStatus"
          },
          "expectedTestAppValue": "Error: Error: Invalid status value"
        },
        {
          "title": "setPresence API Call - Invalid Custom Message Type",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "Available",
            "customMessage": 123
          },
          "expectedTestAppValue": "Error: Error: Error code: 4000, message: Custom message must be a string"
        },
        {
          "title": "getPresence API Call - Whitespace UPN",
          "type": "callResponse",
          "boxSelector": "#box_getPresence",
          "inputValue": {
            "upn": "   "
          },
          "expectedTestAppValue": "Error: Error: Error code: 4000, message: UPN cannot be null or empty"
        },
        {
          "title": "setPresence API Call - Set Out of Office",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "OutOfOffice",
            "customMessage": "On vacation",
            "outOfOfficeDetails": {
              "startTime": "2024-03-20T00:00:00Z",
              "endTime": "2024-03-27T00:00:00Z",
              "message": "Annual leave - back next week"
            }
          },
          "expectedAlertValue": "setPresence called with status: OutOfOffice and message: On vacation\nOOF from 3/20/2024 to 3/27/2024",
          "expectedTestAppValue": "Presence set successfully"
        },
        {
          "title": "getPresence API Call - Get OOF User",
          "type": "callResponse",
          "boxSelector": "#box_getPresence",
          "inputValue": {
            "upn": "oof.user@contoso.com"
          },
          "expectedAlertValue": "getPresence called for user: oof.user@contoso.com",
          "expectedTestAppValue": {
            "status": "OutOfOffice",
            "customMessage": "Mock presence status",
            "outOfOfficeDetails": {
              "startTime": "__ANY_STRING__",
              "endTime": "__ANY_STRING__",
              "message": "On vacation until next week"
            }
          }
        }
      ]
    }
  ]
}
