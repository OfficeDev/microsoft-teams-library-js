{
  "name": "Presence",
  "featureTests": [
    {
      "feature": {
        "id": "presence",
        "version": 3
      },
      "testCases": [
        {
          "title": "getPresence API Call - Success",
          "type": "callResponse",
          "boxSelector": "#box_getPresence",
          "inputValue": {
            "upn": "user@contoso.com"
          },
          "expectedAlertValue": "getPresence called for user: user@contoso.com",
          "expectedTestAppValue": {
            "status": "Available",
            "customMessage": "Default status message"
          }
        },
        {
          "title": "getPresence API Call - Invalid UPN",
          "type": "callResponse",
          "boxSelector": "#box_getPresence",
          "inputValue": {
            "upn": ""
          },
          "expectedTestAppValue": "Error: Error: UPN is required"
        },
        {
          "title": "setPresence API Call - Success with valid message",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "Busy",
            "customMessage": "In a meeting with clients"
          },
          "expectedAlertValue": "setPresence called with status: Busy and message: In a meeting with clients",
          "expectedTestAppValue": "Presence set successfully"
        },
        {
          "title": "setPresence API Call - Fail without message",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "Available"
          },
          "expectedTestAppValue": "Error: Custom message is required and must be at least 5 characters long"
        },
        {
          "title": "setPresence API Call - Fail with short message",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "Available",
            "customMessage": "Hi"
          },
          "expectedTestAppValue": "Error: Custom message is required and must be at least 5 characters long"
        },
        {
          "title": "setPresence API Call - Set Out of Office",
          "type": "callResponse",
          "boxSelector": "#box_setPresence",
          "inputValue": {
            "status": "OutOfOffice",
            "customMessage": "On vacation until next week",
            "outOfOfficeDetails": {
              "startTime": "2024-03-20T00:00:00Z",
              "endTime": "2024-03-27T00:00:00Z",
              "message": "Annual leave - back next week"
            }
          },
          "expectedAlertValue": "setPresence called with status: OutOfOffice and message: On vacation until next week\nOOF from 3/20/2024 to 3/27/2024",
          "expectedTestAppValue": "Presence set successfully"
        },
        {
          "title": "getPresence API Call - Get OOF User",
          "type": "callResponse",
          "boxSelector": "#box_getPresence",
          "inputValue": {
            "upn": "oof.user@contoso.com"
          },
          "expectedAlertValue": "getPresence called for user: oof.user@contoso.com",
          "expectedTestAppValue": {
            "status": "OutOfOffice",
            "customMessage": "Out of office until next week",
            "outOfOfficeDetails": {
              "startTime": "__ANY_STRING__",
              "endTime": "__ANY_STRING__",
              "message": "On vacation until next week"
            }
          }
        }
      ]
    }
  ]
}
