{
  "name": "nestedAppAuth",
  "platforms": "*",
  "version": ">=2.22.0",
  "cypressTopWindowReplacement": true,
  "testCases": [
    {
      "title": "nestedAppAuth isNAAChannelRecommended API Call - Success",
      "type": "callResponse",
      "boxSelector": "#box_checkIsNAAChannelRecommended",
      "expectedTestAppValue": "NAA channel is recommended"
    },
    {
      "title": "nestedAppAuth get parent origin",
      "type": "callResponse",
      "version": ">2.35.0",
      "boxSelector": "#box_getParentOrigin",
      "platformsExcluded": ["iOS", "Android"],
      "expectedTestAppValue": "https://local.teams.office.com:8080"
    },
    {
      "title": "nestedAppAuth isDeeplyNestedAuthSupported API Call - Success",
      "type": "callResponse",
      "version": ">2.35.0",
      "boxSelector": "#box_checkIsDeeplyNestedAuthSupported",
      "hostSdkVersion": {
        "web": ">=7.1.0",
        "android": ">=6.0.0",
        "ios": ">=6.0.0"
      },
      "expectedTestAppValue": "NAA deeply nested auth is supported"
    },
    {
      "title": "nestedAppAuth - send message to NAA bridge from parent window",
      "type": "callResponse",
      "boxSelector": "#box_sendMessageToNestedAppAuthBridge",
      "inputValue": {
        "messageType": "NestedAppAuthRequest",
        "method": "GetToken",
        "sendTime": 1732269811006,
        "clientLibrary": "MetaOS",
        "clientLibraryVersion": "1.0.0",
        "requestId": "684352c2-7ab7-4def-b7e1-XXXXXXXXXXX",
        "tokenParams": { "correlationId": "39dc85fe-9054-11ed-a1eb-XXXXXXXXXXX" }
      },
      "expectedAlertValue": "nestedAppAuth.execute called with payload: ##JSON_INPUT_VALUE##, origin: https://localhost:4000/, isTrustedOrigin: true",
      "expectedTestAppValue": "\"{\\\"messageType\\\":\\\"NestedAppAuthResponse\\\",\\\"requestId\\\":\\\"684352c2-7ab7-4def-b7e1-XXXXXXXXXXX\\\",\\\"success\\\":true,\\\"initContext\\\":{\\\"sdkName\\\":\\\"OfficeAuth\\\",\\\"sdkVersion\\\":\\\"16.0.18015.15000\\\",\\\"capabilities\\\":{\\\"queryAccount\\\":false},\\\"accountContext\\\":{\\\"homeAccountId\\\":\\\"bb5r835b-XXXX\\\",\\\"environment\\\":\\\"login.windows.net\\\",\\\"tenantId\\\":\\\"2855cd1be\\\"}}}\""
    }
  ]
}
